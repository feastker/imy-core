# Сводка изменений: Добавлена поддержка MySQL и MariaDB

## Обзор

Imy Core ORM теперь явно поддерживает работу как с MySQL, так и с MariaDB. Хотя оба драйвера используют один и тот же PDO драйвер, теперь вы можете явно указать тип базы данных в конфигурации и получить доступ к специфичным возможностям каждой СУБД.

## Основные изменения

### 1. Обновлен класс DB

**Файл:** `DB.php`

**Изменения:**
- Добавлена поддержка параметра `driver` в конфигурации
- Улучшена обработка DSN параметров
- Служебные параметры теперь автоматически исключаются из DSN строки
- MySQL/MariaDB специфичные константы PDO применяются только для соответствующих драйверов

### 2. Обновлен пример конфигурации

**Файл:** `config_sample.php`

**Изменения:**
- Добавлен параметр `driver`
- Добавлены параметры `port` и `charset`
- Параметр `name` изменен на `dbname` (стандарт PDO)
- Добавлены подробные комментарии

### 3. Создана документация

#### README.md
Полностью переписан с добавлением:
- Информации о поддерживаемых базах данных
- Инструкций по настройке
- Примеров использования
- Информации о миграциях

#### QUICKSTART.md
Краткое руководство для быстрого старта с:
- Пошаговой настройкой
- Примерами основных операций
- Ссылками на дополнительную документацию

#### MIGRATION_GUIDE.md
Подробное руководство с:
- Инструкциями по миграции
- Примерами конфигураций
- Особенностями MySQL и MariaDB
- Устранением проблем

#### UPGRADE.md
Руководство по обновлению с:
- Списком критических изменений
- Пошаговыми инструкциями
- Решением проблем
- Инструкциями по откату

#### CHANGELOG.md
История изменений проекта

### 4. Создан тестовый скрипт

**Файл:** `test_connection.php`

Скрипт для проверки подключения к базе данных:
- Проверяет конфигурацию
- Тестирует подключение
- Выполняет проверку всех операций (CREATE, INSERT, SELECT, UPDATE, DELETE)
- Выводит информацию о версии и типе СУБД

### 5. Созданы примеры использования

**Директория:** `examples/`

#### basic_usage.php
12 примеров базовых операций:
- SELECT, INSERT, UPDATE, DELETE
- JOIN запросы
- Сложные условия WHERE
- Агрегатные функции
- GROUP BY и HAVING
- Транзакции
- Множественные подключения
- ON DUPLICATE KEY UPDATE
- Прямые SQL запросы

#### model_usage.php
13 примеров работы с моделями:
- Создание и определение моделей
- CRUD операции
- Поиск и фильтрация
- Копирование записей
- Query Builder через модели
- Пользовательские методы
- Составные первичные ключи
- Отладка запросов

#### examples/README.md
Документация к примерам с:
- Инструкциями по запуску
- SQL для создания таблиц
- Описанием каждого примера
- Советами по отладке и производительности

## Новые возможности

### Явная поддержка драйверов

```php
'db' => [
    'default' => [
        'driver' => 'mysql'  // или 'mariadb'
    ]
]
```

### Стандартные DSN параметры

```php
'db' => [
    'default' => [
        'driver'   => 'mysql',
        'host'     => 'localhost',
        'port'     => 3306,      // Новый параметр
        'dbname'   => 'mydb',    // Вместо 'name'
        'charset'  => 'utf8mb4'  // Новый параметр
    ]
]
```

### Множественные подключения

```php
'db' => [
    'default' => [
        'driver' => 'mysql',
        'dbname' => 'main_db',
        // ...
    ],
    'analytics' => [
        'driver' => 'mariadb',
        'dbname' => 'analytics_db',
        // ...
    ]
]
```

## Критические изменения (Breaking Changes)

### Параметр конфигурации 'name' больше не поддерживается

**Было:**
```php
'name' => 'database_name'
```

**Стало:**
```php
'dbname' => 'database_name'
```

## Миграция существующих проектов

### Шаг 1: Обновите DB.php
```bash
# Создайте резервную копию
cp DB.php DB.php.backup

# Обновите файл на новую версию
```

### Шаг 2: Обновите конфигурацию
```php
// В config.php измените:
'name' => 'mydb'    // старое
// на:
'dbname' => 'mydb'  // новое
```

### Шаг 3: Проверьте подключение
```bash
php test_connection.php
```

## Совместимость

- **PHP:** 7.4+
- **MySQL:** 5.7+, 8.0+
- **MariaDB:** 10.2+, 10.5+
- **PDO:** Обязательно

## Файловая структура

```
imy-core/
├── DB.php                    # ✏️ Обновлен
├── config_sample.php         # ✏️ Обновлен
├── README.md                 # ✏️ Обновлен
├── QUICKSTART.md            # ✨ Новый
├── MIGRATION_GUIDE.md       # ✨ Новый
├── UPGRADE.md               # ✨ Новый
├── CHANGELOG.md             # ✨ Новый
├── SUMMARY.md               # ✨ Новый (этот файл)
├── test_connection.php      # ✨ Новый
└── examples/                # ✨ Новая директория
    ├── README.md            # ✨ Новый
    ├── basic_usage.php      # ✨ Новый
    └── model_usage.php      # ✨ Новый
```

## Быстрый старт

### 1. Настройка
```bash
cp config_sample.php config.php
# Отредактируйте config.php
```

### 2. Проверка
```bash
php test_connection.php
```

### 3. Использование
```php
use Imy\Core\DBSelect;

$users = DBSelect::factory('users')
    ->where('status', 1)
    ->fetchAssocAll();
```

## Дополнительные ресурсы

- **Быстрый старт:** [QUICKSTART.md](QUICKSTART.md)
- **Полная документация:** [README.md](../README.md)
- **Руководство по миграции:** [MIGRATION_GUIDE.md](MIGRATION_GUIDE.md)
- **Обновление:** [UPGRADE.md](UPGRADE.md)
- **Примеры кода:** [examples/](../examples/)
- **История изменений:** [CHANGELOG.md](CHANGELOG.md)

## Тестирование

### Автоматический тест подключения
```bash
php test_connection.php
```

### Примеры использования
```bash
php examples/basic_usage.php
php examples/model_usage.php
```

## Поддержка

Если возникли проблемы:

1. Прочитайте [UPGRADE.md](UPGRADE.md) для инструкций по обновлению
2. Запустите `test_connection.php` для диагностики
3. Изучите примеры в `examples/`
4. Обратитесь к [MIGRATION_GUIDE.md](MIGRATION_GUIDE.md)

## Что дальше?

1. Обновите существующие проекты (см. [UPGRADE.md](UPGRADE.md))
2. Изучите примеры в `examples/`
3. Прочитайте [QUICKSTART.md](QUICKSTART.md) для быстрого старта
4. Начните использовать новые возможности!

---

**Версия:** 1.0.1  
**Дата:** 2025-10-11  
**Автор обновления:** AI Assistant

